FROM python:3.14-alpine

RUN addgroup -g 1000 appgroup && \
    adduser -u 1000 -G appgroup -D appuser

WORKDIR /app

RUN pip install --no-cache-dir \
    "fastmcp>=3.0.0" \
    httpx>=0.28.0 \
    pytest>=8.0.0 \
    pytest-asyncio>=0.23.0

COPY tests/mcp_client_test.py ./tests/
COPY tests/mcp_live_test.py ./tests/
COPY tests/debug_connection.py ./tests/

RUN chown -R appuser:appgroup /app

USER appuser

ENV PYTHONPATH=/app

CMD ["python", "tests/debug_connection.py"]
