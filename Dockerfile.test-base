FROM python:3.14-alpine

RUN apk add --no-cache curl

WORKDIR /app

RUN addgroup -g 1000 appgroup && \
    adduser -u 1000 -G appgroup -D appuser && \
    mkdir -p /app/data

ENV PYTHONPATH=/app

COPY --chown=appuser:appgroup pyproject.toml .

RUN pip install --no-cache-dir -e . && \
    pip install --no-cache-dir ruff mypy pytest pytest-asyncio

USER appuser
